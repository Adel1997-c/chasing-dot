<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chasing Dot</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      margin: 0;
    }
    #info, #combo-msg, #challenge-msg {
      margin-top: 10px;
      font-size: 1.1rem;
      text-align: center;
    }
    #combo-msg {
      color: gold;
      font-weight: bold;
    }
    #grid {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      grid-template-rows: repeat(3, 100px);
      gap: 10px;
      margin: 20px 0;
    }
    .cell {
      background: #333;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      cursor: pointer;
      user-select: none;
    }
    button {
      margin: 6px;
      padding: 6px 12px;
      background: #444;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #666;
    }
  </style>
</head>
<body>
  <h1>üéØ Chasing Dot</h1>
  <div id="info">
    ‚è± Time: <span id="timer">0</span>s |
    üíØ Score: <span id="score">0</span> |
    üèÜ High Score: <span id="highscore">0</span>
  </div>

  <div id="combo-msg"></div>
  <div id="challenge-msg"></div>

  <button id="hardModeBtn">Hard Mode: OFF</button>
  <button id="challengeModeBtn">Challenge Mode: OFF</button>
  <div id="grid"></div>

  <button onclick="downloadGame()">‚¨áÔ∏è Download Game</button>

  <!-- Sound & Ad Scripts -->
  <audio id="failSound" src="sounds/fail.mp3" preload="auto"></audio>
  <audio id="bgMusic" src="sounds/bg.mp3" preload="auto" loop></audio>
  <audio id="cheerSound" src="sounds/cheer.mp3" preload="auto"></audio>

  <!-- Example Adsterra (replace with your ad script) -->
  <script type='text/javascript' src='//your-ad-network-script.js'></script>

  <script>
    const grid = document.getElementById('grid');
    const scoreEl = document.getElementById('score');
    const timerEl = document.getElementById('timer');
    const highscoreEl = document.getElementById('highscore');
    const comboMsg = document.getElementById('combo-msg');
    const challengeMsg = document.getElementById('challenge-msg');
    const hardBtn = document.getElementById('hardModeBtn');
    const challengeBtn = document.getElementById('challengeModeBtn');

    const failSound = document.getElementById('failSound');
    const bgMusic = document.getElementById('bgMusic');
    const cheerSound = document.getElementById('cheerSound');

    let score = 0, combo = 0, time = 0;
    let activeIndex = -1;
    let speed = 1000;
    let hardMode = false;
    let challengeMode = false;
    let gameStarted = false;
    let soundStarted = false;

    let hitsInChallenge = 0;
    let challengeActive = false;
    let timer, loop, challengeTimer;

    const highscore = localStorage.getItem('dotHighScore') || 0;
    highscoreEl.textContent = highscore;

    hardBtn.onclick = () => {
      if (gameStarted) return;
      hardMode = !hardMode;
      hardBtn.textContent = `Hard Mode: ${hardMode ? 'ON' : 'OFF'}`;
      speed = hardMode ? 500 : 1000;
    };

    challengeBtn.onclick = () => {
      if (gameStarted) return;
      challengeMode = !challengeMode;
      challengeBtn.textContent = `Challenge Mode: ${challengeMode ? 'ON' : 'OFF'}`;
    };

    for (let i = 0; i < 9; i++) {
      const cell = document.createElement('div');
      cell.className = 'cell';
      cell.dataset.index = i;
      grid.appendChild(cell);
    }

    const cells = document.querySelectorAll('.cell');

    function showFirstDot() {
      const index = Math.floor(Math.random() * 9);
      cells[index].textContent = 'üî¥';
      activeIndex = index;
    }

    function randomDot() {
      if (activeIndex >= 0) cells[activeIndex].textContent = '';
      const index = Math.floor(Math.random() * 9);
      cells[index].textContent = 'üî¥';
      activeIndex = index;

      setTimeout(() => {
        if (cells[index].textContent === 'üî¥') endGame();
      }, hardMode ? 1000 : speed - 100);
    }

    function handleClick(e) {
      if (e.target.textContent !== 'üî¥') return endGame();

      e.target.textContent = 'üü¢';
      score++; combo++;
      scoreEl.textContent = score;

      if (!soundStarted) {
        bgMusic.volume = 0.3;
        bgMusic.play().catch(() => {});
        soundStarted = true;
      }

      if (!gameStarted) {
        gameStarted = true;
        hardBtn.disabled = true;
        challengeBtn.disabled = true;
        loop = setInterval(randomDot, speed);
        startTimer();
        if (challengeMode) startChallenge();
      }

      if (combo % 10 === 0) {
        comboMsg.textContent = `üî• COMBO x${combo}!`;
        cheerSound.pause(); cheerSound.currentTime = 0; cheerSound.play();
      } else {
        comboMsg.textContent = '';
      }

      if (challengeActive) {
        hitsInChallenge++;
        challengeMsg.textContent = `üéØ Challenge: ${hitsInChallenge}/5`;
        if (hitsInChallenge >= 5) {
          challengeMsg.textContent = 'üéâ Challenge Completed!';
          clearTimeout(challengeTimer);
          challengeActive = false;
        }
      }

      clearInterval(loop);
      speed = Math.max(hardMode ? 200 : 300, speed - 30);
      setTimeout(() => {
        loop = setInterval(randomDot, speed);
      }, 100);
    }

    function startTimer() {
      timer = setInterval(() => {
        time++;
        timerEl.textContent = time;
      }, 1000);
    }

    function startChallenge() {
      hitsInChallenge = 0;
      challengeActive = true;
      challengeMsg.textContent = 'üéØ Challenge: 0/5 (10s)';
      challengeTimer = setTimeout(() => {
        if (hitsInChallenge < 5) {
          challengeMsg.textContent = '‚ùå Time‚Äôs up! Challenge failed.';
        }
        challengeActive = false;
      }, 10000);
    }

    function endGame() {
      clearInterval(loop);
      clearInterval(timer);
      failSound.pause(); failSound.currentTime = 0;
      failSound.play();
      bgMusic.pause();
      comboMsg.textContent = '';
      challengeMsg.textContent = '';
      const best = localStorage.getItem('dotHighScore') || 0;
      if (score > best) {
        localStorage.setItem('dotHighScore', score);
        alert("üéâ NEW HIGH SCORE: " + score);
      } else {
        alert("Game Over! Your score: " + score);
      }
      location.reload();
    }

    function downloadGame() {
      window.open("https://your-zip-download-link.com/chasing-dot.zip", "_blank");
    }

    cells.forEach(cell => cell.addEventListener('click', handleClick));
    showFirstDot();
  </script>
</body>
</html>
