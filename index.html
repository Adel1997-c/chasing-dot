<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chasing Dot</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
    }
    h1 {
      margin-top: 30px;
    }
    #info {
      margin-top: 10px;
      font-size: 1.2rem;
    }
    #grid {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      grid-template-rows: repeat(3, 100px);
      gap: 12px;
      margin: 30px 0;
    }
    .cell {
      width: 100px;
      height: 100px;
      background: #2c2c2c;
      border-radius: 12px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: background 0.3s;
    }
    .dot {
      width: 40px;
      height: 40px;
      background: radial-gradient(circle at top left, #ff5f6d, #d1345b);
      border-radius: 50%;
    }
    #pauseBtn {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 8px 12px;
      background: #333;
      border: none;
      border-radius: 4px;
      color: white;
      cursor: pointer;
    }
    #gameOver {
      display: none;
      font-size: 1.2rem;
      margin-top: 20px;
      color: #ff6666;
    }
    #download {
      background: #2d87f0;
      color: white;
      padding: 8px 14px;
      border: none;
      border-radius: 6px;
      margin-top: 20px;
      cursor: pointer;
    }
    #ad-box {
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <h1>üéØ Chasing Dot</h1>
  <div id="info">
    ‚è± Time: <span id="time">0</span>s |
    üíØ Score: <span id="score">0</span> |
    ü•á High Score: <span id="highscore">0</span> |
    ‚ù§Ô∏è Lives: <span id="lives">3</span>
  </div>
  <button id="pauseBtn">‚è∏ Pause</button>
  <div id="grid"></div>
  <div id="gameOver">‚õî Game Over. Cooldown: <span id="cooldown">300</span>s</div>
  <a id="download" href="./chasing-dot.zip" download>üì± Download Game</a>
  <div id="ad-box">
    <iframe src="https://www.profitableratecpm.com/drmjgriq2?key=f3d635f9a014d5973a07432322c6ea01"
            style="width:100%; height:60px; border:none;" scrolling="no"></iframe>
  </div>

  <script>
    const grid = document.getElementById('grid');
    const timeEl = document.getElementById('time');
    const scoreEl = document.getElementById('score');
    const highscoreEl = document.getElementById('highscore');
    const livesEl = document.getElementById('lives');
    const gameOver = document.getElementById('gameOver');
    const cooldownEl = document.getElementById('cooldown');
    const pauseBtn = document.getElementById('pauseBtn');

    let time = 0;
    let score = 0;
    let highscore = parseInt(localStorage.getItem('highscore') || '0');
    let lives = 3;
    let currentDot = 4;
    let interval;
    let moveSpeed = 1000;
    let paused = false;
    let cooldownActive = false;

    highscoreEl.textContent = highscore;

    // Create Grid
    for (let i = 0; i < 9; i++) {
      const cell = document.createElement('div');
      cell.classList.add('cell');
      cell.addEventListener('click', () => handleClick(i));
      grid.appendChild(cell);
    }

    function placeDot(index) {
      document.querySelectorAll('.cell').forEach(c => c.innerHTML = '');
      const dot = document.createElement('div');
      dot.classList.add('dot');
      grid.children[index].appendChild(dot);
    }

    function handleClick(index) {
      if (paused || lives <= 0 || cooldownActive) return;
      const cell = grid.children[index];
      if (index === currentDot) {
        score++;
        scoreEl.textContent = score;
        if (score > highscore) {
          highscore = score;
          highscoreEl.textContent = highscore;
          localStorage.setItem('highscore', highscore);
        }
        if (score % 10 === 0) moveSpeed *= 0.9;
        moveDot();
      } else {
        const audio = new Audio('sounds/fail.mp3');
        audio.play();
        cell.style.background = '#c0392b';
        setTimeout(() => cell.style.background = '', 400);
        lives--;
        livesEl.textContent = lives;
        if (lives <= 0) triggerGameOver();
      }
    }

    function moveDot() {
      const next = Math.floor(Math.random() * 9);
      currentDot = next;
      placeDot(currentDot);
      clearInterval(interval);
      interval = setInterval(() => moveDot(), moveSpeed);
    }

    function startTimer() {
      setInterval(() => {
        if (!paused && lives > 0 && !cooldownActive) {
          time++;
          timeEl.textContent = time;
        }
      }, 1000);
    }

    function triggerGameOver() {
      clearInterval(interval);
      gameOver.style.display = 'block';
      cooldownActive = true;
      let cooldown = 300;
      cooldownEl.textContent = cooldown;
      const timer = setInterval(() => {
        cooldown--;
        cooldownEl.textContent = cooldown;
        if (cooldown <= 0) {
          clearInterval(timer);
          cooldownActive = false;
          resetGame();
        }
      }, 1000);
    }

    function resetGame() {
      score = 0;
      lives = 3;
      time = 0;
      moveSpeed = 1000;
      scoreEl.textContent = score;
      livesEl.textContent = lives;
      timeEl.textContent = time;
      gameOver.style.display = 'none';
      currentDot = 4;
      placeDot(currentDot);
      moveDot();
    }

    pauseBtn.addEventListener('click', () => {
      paused = !paused;
      pauseBtn.textContent = paused ? '‚ñ∂Ô∏è Resume' : '‚è∏ Pause';
    });

    // Start game
    placeDot(currentDot);
    moveDot();
    startTimer();
  </script>
</body>
</html>
